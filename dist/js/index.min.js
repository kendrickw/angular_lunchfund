(function(){var a=angular.module("copyright",[]);a.directive("copyright",function(){return{scope:{},restrict:"AE",templateUrl:"templates/copyright.html",replace:!0,controller:"CopyrightController",controllerAs:"CopyrightCtrl"}});a.controller("CopyrightController",["$window",function(a){angular.extend(this,{COPYRIGHT_TEXT:a.COPYRIGHT_TEXT})}])})();(function(){var a=angular.module("fundChart",["googlechart","globalFactory"]);a.directive("fundChart",function(){return{scope:{},restrict:"AE",templateUrl:"templates/fundchart.html",replace:!0,controller:"FundChartController",controllerAs:"FundChartCtrl"}});a.controller("FundChartController",["$http","$filter","global",function(a,f,e){function c(d){if(d<=b.length&&b[d-1].id===d)return b[d-1];var c;for(c=0;c<b.length;c+=1)if(b[c].id===d)return b[c];console.error("ID#"+d+" is not a valid luncher ID.");
return null}var b=e.get("lunchers"),g=e.get("loginUser"),d={type:"BarChart",cssStyle:"",data:{cols:[{label:"",type:"string"}],rows:[{c:[{v:""}]}]},options:{isStacked:"true",fill:20,vAxis:{gridlines:{count:0}},hAxis:{title:"Fund ($)"}},formatters:{}};a.get("/db/luncherstat").success(function(b){var a,e=0;b.sort(function(b,a){return a.total_fund_contrib-b.total_fund_contrib});for(a=0;a<b.length;a+=1)3>a||b[a].luncher_id===g.id?(d.data.cols.push({label:c(b[a].luncher_id).username,type:"number"}),d.data.rows[0].c.push({v:b[a].total_fund_contrib,
f:"$"+f("number")(b[a].total_fund_contrib,2)})):e+=b[a].total_fund_contrib;d.data.cols.push({label:"Others",type:"number"});d.data.rows[0].c.push({v:e,f:"$"+f("number")(e,2)})});this.chart=d}])})();(function(){var a=angular.module("fundForm",["globalFactory","alertService"]);a.directive("fundForm",function(){return{scope:{},restrict:"AE",templateUrl:"templates/fundform.html",replace:!0,controller:"FundController",controllerAs:"FundCtrl"}});a.controller("FundController",["$http","global","alert",function(a,f,e){function c(){return b.billAmount?b.fundholder?b.attendee().length?!0:(b.alert.add("danger","No one is going to lunch?"),!1):(b.alert.add("danger","Please specify a fundholder."),!1):(b.alert.add("danger",
"Bill Amount '"+b.billAmount+"' is not valid."),!1)}var b=this;angular.extend(b,{alert:e,today:new Date,eventdate:new Date,attendee:function(){return f.get("attendee")},billAmount:"",tipsAmount:0,totalAmount:0,tipPercent:10,eachPays:0,fundholder:"",dateOpened:!1,dateOptions:{"show-weeks":!1,"max-mode":"day"}});var g=0;angular.extend(b,{dateOpen:function(a){a.preventDefault();a.stopPropagation();b.dateOpened=!0},getLunchfundAmount:function(){if(b.billAmount){b.totalAmount=Math.ceil(1.1*b.billAmount);
b.tipsAmount=b.totalAmount-b.billAmount;b.tipPercent=b.tipsAmount/b.billAmount*100;var a=b.attendee().length;0<a&&(b.eachPays=Math.ceil(b.totalAmount/a));g=b.eachPays*a-b.totalAmount}return g},submit:function(){var e={time:b.eventdate,bill:b.billAmount,totalpaid:b.totalAmount,fund:g,attendee:b.attendee(),fundholder:b.fundholder,submitter:f.get("loginUser")};c()&&a.post("db/event",e).success(function(a){f.get("events").unshift(e);b.alert.add("success","Lunchfund submitted successfully.")}).error(function(a,
c,e,d){b.alert.add("danger",JSON.stringify(a))})}})}])})();(function(){angular.module("globalFactory",[]).factory("global",["$window","$http",function(a,h){var f={locale:navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,development:a.development,loginUser:a.currentuser,lunchers:[],attendee:[],events:[]};h.get("/db/lunchers").success(function(a){var c=f.lunchers,b=f.attendee,g=f.loginUser,d;for(d=0;d<a.length;d+=1)5>d&&b.push(a[d]),c.push(a[d]),a[d].firstname===g.firstname&&a[d].lastname===g.lastname&&angular.extend(g,a[d])});
h.get("/db/events",{params:{count:2}}).success(function(a){f.events=a});return{get:function(a){return f[a]},set:function(a,c){f[a]=c}}}])})();(function(){angular.module("index","ui.bootstrap ui.router angular-loading-bar titleMenu luncherSelect fundForm pastEvent copyright fundChart".split(" ")).config(["$stateProvider","$urlRouterProvider",function(a,h){h.otherwise("/home");a.state("home",{url:"/home",templateUrl:"templates/home.html"}).state("dashboard",{url:"/dashboard",templateUrl:"templates/dashboard.html"}).state("setting",{url:"/setting",templateUrl:"templates/setting.html"})}])})();(function(){var a=angular.module("luncherSelect",["globalFactory"]);a.directive("luncherSelect",function(){return{scope:{},restrict:"AE",templateUrl:"templates/luncherselect.html",replace:!0,controller:"LuncherController",controllerAs:"LuncherCtrl"}});a.controller("LuncherController",["$scope","$modal","global",function(a,f,e){var c=this;angular.extend(c,{editMode:!1,lunchers:function(){return e.get("lunchers")},attendee:function(){return e.get("attendee")}});angular.extend(c,{toggleEdit:function(){c.editMode=
!c.editMode},isAttending:function(a){return-1!==c.attendee().indexOf(a)},toggle:function(a){var e=c.attendee().indexOf(a);-1!==e?c.attendee().splice(e,1):c.attendee().push(a)}})}])})();(function(){var a=angular.module("pastEvent",["globalFactory"]);a.directive("pastEvent",function(){return{scope:{},restrict:"AE",templateUrl:"templates/pastevent.html",replace:!0,controller:"EventController",controllerAs:"EventCtrl"}});a.controller("EventController",["global",function(a){this.events=function(){return a.get("events")}}])})();(function(){var a=angular.module("titleMenu",["globalFactory"]);a.directive("titleMenu",function(){return{scope:{},restrict:"AE",templateUrl:"templates/titlemenu.html",replace:!0,controller:"MenuController",controllerAs:"MenuCtrl"}});var h=[{id:0,name:"Home",description:"",icon:"glyphicon glyphicon-home",link:"#/home"},{id:1,name:"Dashboard",description:"Show lunchfund performance",icon:"glyphicon glyphicon-dashboard",link:"#/dashboard"},{id:2,name:"Settings",description:"",icon:"glyphicon glyphicon-cog",
link:"#/setting"}];a.controller("MenuController",["$location","global",function(a,e){var c=this;angular.extend(c,{allPages:h,development:e.get("development"),currentPageID:0,loginUser:function(){return e.get("loginUser")},navCollapsed:!0,sidemenuOpen:!1});var b,g=new RegExp(a.path()+"$");for(b=0;b<h.length;b+=1)if(g.test(h[b].link)){c.currentPageID=h[b].id;break}angular.extend(c,{toggleNav:function(){c.navCollapsed=!c.navCollapsed},toggleSidemenu:function(){c.sidemenuOpen=!c.sidemenuOpen},getPage:function(){return c.allPages[c.currentPageID]},
setPage:function(a){c.currentPageID=a||0}})}])})();
